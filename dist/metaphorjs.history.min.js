'use strict';(function(){function t(){return!1}function u(){return!0}function p(a){return"object"==typeof a&&3===H(a)&&!a.nodeType&&a.constructor===Object}function C(a){return!0===a||!1===a}function I(){}function D(a,b,c,e){return setTimeout(function(){a.apply(b,c||[])},e||0)}var q=Array.prototype.slice,J=Object.prototype.toString,H=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};
return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var c=a[J.call(b)];return void 0===c?-1:1==c&&isNaN(b)?8:c}}(),m=function(){return function b(){var c=!1,e=!1,f=q.call(arguments),g=f.shift(),d,h,k;C(f[f.length-1])&&(c=f.pop());C(f[f.length-1])&&(e=c,c=f.pop());for(;f.length;)if(d=f.shift())for(h in d)if(d.hasOwnProperty(h)&&void 0!==(k=d[h]))if(e)if(g[h]&&p(g[h])&&p(k))b(g[h],k,c,e);else{if(!0===c||void 0==g[h])p(k)?(g[h]={},b(g[h],k,c,!0)):g[h]=k}else if(!0===c||void 0==g[h])g[h]=
k;return g}}(),w=function(a){if(a instanceof w)return a;if(!(this instanceof w))return new w(a);for(var b in a)if(!this[b])try{this[b]=a[b]}catch(c){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var e,f=a.button;void 0===this.pageX&&null!==a.clientX&&(e=this.target?this.target.ownerDocument||window.document:window.document,b=e.documentElement,e=e.body,this.pageX=a.clientX+(b&&b.scrollLeft||e&&e.scrollLeft||0)-(b&&b.clientLeft||e&&e.clientLeft||0),this.pageY=
a.clientY+(b&&b.scrollTop||e&&e.scrollTop||0)-(b&&b.clientTop||e&&e.clientTop||0));this.which||void 0===f||(this.which=f&1?1:f&2?3:f&4?2:0);this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?u:t;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};m(w.prototype,{isDefaultPrevented:t,isPropagationStopped:t,isImmediatePropagationStopped:t,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=u;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},
stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=u;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=u;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}},!0,!1);var E=function(a){function b(){e=null}var c,e;a=function(a){return function(g){var d=new w(g||window.event),h=q.call(arguments,1),k=0,n=0,l=0,m=0,s=0,r=0;d.type="mousewheel";"detail"in d&&
(l=-1*d.detail);"wheelDelta"in d&&(l=d.wheelDelta);"wheelDeltaY"in d&&(l=d.wheelDeltaY);"wheelDeltaX"in d&&(n=-1*d.wheelDeltaX);"axis"in d&&d.axis===d.HORIZONTAL_AXIS&&(n=-1*l,l=0);k=0===l?n:l;"deltaY"in d&&(k=l=-1*d.deltaY);"deltaX"in d&&(n=d.deltaX,0===l&&(k=-1*n));if(0!==l||0!==n){m=Math.max(Math.abs(l),Math.abs(n));if(!e||m<e)e=m,"mousewheel"===d.type&&0===m%120&&(e/=40);"mousewheel"===d.type&&0===m%120&&(k/=40,n/=40,l/=40);k=Math[1<=k?"floor":"ceil"](k/e);n=Math[1<=n?"floor":"ceil"](n/e);l=Math[1<=
l?"floor":"ceil"](l/e);this.getBoundingClientRect&&(m=this.getBoundingClientRect(),s=d.clientX-m.left,r=d.clientY-m.top);d.deltaX=n;d.deltaY=l;d.deltaFactor=e;d.offsetX=s;d.offsetY=r;d.deltaMode=0;h.unshift(d,k,n,l);c&&clearTimeout(c);c=setTimeout(b,200);return a.apply(this,h)}}};a.events=function(){var b=window.document;return"onwheel"in b||9<=b.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]};return a}(),A=function(){var a=null,b=null;return function(c,e,f){null===a&&
(a=c.attachEvent?"attachEvent":"addEventListener",b=c.attachEvent?"on":"");if("mousewheel"==e){f=E(f);e=E.events();var g,d;g=0;for(d=e.length;g<d;g++)c[a](b+e[g],f,!1)}else c[a](b+e,f,!1);return f}}(),K=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},L=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]="0";else return a[b]=String.fromCharCode(c+
1),a.join("")}a.unshift("0");return a.join("")}}(),F=function(){var a=function(b,c,a,f,g){this.name=b;this.listeners=[];this.map={};this.hash=L();this.uni="$$"+b+"_"+this.hash;this.suspended=!1;this.lid=0;"object"==typeof c&&null!==c?m(this,c,!0,!1):(this.returnResult=void 0===c?null:c,this.autoTrigger=a,this.triggerFilter=f,this.filterContext=g)};m(a.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,returnResult:null,autoTrigger:null,lastTrigger:null,triggerFilter:null,
filterContext:null,getName:function(){return this.name},destroy:function(){for(var b in this)this[b]=null},on:function(b,c,a){if(!b)return null;c=c||null;a=a||{};var f=this.uni,g=c||b;if(g[f]&&!a.allowDupes)return null;var d=++this.lid,h=a.first||!1;g[f]=d;b={fn:b,context:c,uniContext:g,id:d,called:0,limit:0,start:1,count:0,append:null,prepend:null};m(b,a,!0,!1);h?this.listeners.unshift(b):this.listeners.push(b);this.map[d]=b;if(this.autoTrigger&&this.lastTrigger&&!this.suspended){var k=this.triggerFilter;
this.triggerFilter=function(b){return b.id==d?k?!1!==k(b):!0:!1};this.trigger.apply(this,this.lastTrigger);this.triggerFilter=k}return d},once:function(b,c,a){a=a||{};a.limit=1;return this.on(b,c,a)},un:function(b,c){var a=-1,f=this.uni,g=this.listeners,d;d=b==parseInt(b)?b:(c||b)[f];if(!d)return!1;for(var h=0,k=g.length;h<k;h++)if(g[h].id==d){a=h;delete g[h].uniContext[f];break}if(-1==a)return!1;g.splice(a,1);delete this.map[d];return!0},hasListener:function(b,c){var a=this.listeners,f;if(b){f="function"!=
typeof b?b:(c||b)[this.uni];if(!f)return!1;for(var g=0,d=a.length;g<d;g++)if(a[g].id==f)return!0;return!1}return 0<a.length},removeAllListeners:function(){var b=this.listeners,c=this.uni,a,f;a=0;for(f=b.length;a<f;a++)delete b[a].uniContext[c];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(b,c){var a;b.append||b.prepend?(a=q.call(c),b.prepend&&(a=b.prepend.concat(a)),b.append&&(a=a.concat(b.append))):a=c;return a},trigger:function(){var b=
this.listeners,a=this.returnResult,e=this.triggerFilter,f=this.filterContext,g;if(this.suspended)return null;this.autoTrigger&&(this.lastTrigger=q.call(arguments));if(0==b.length)return null;for(var d="all"==a||"merge"==a?[]:null,h,b="first"==a?[b[0]]:q.call(b);h=b.shift();)if(h&&this.map[h.id]&&(g=this._prepareArgs(h,arguments),!e||!1!==e.call(f,h,g,this))&&(h.count++,!(h.count<h.start)))if(g=h.fn.apply(h.context,g),h.called++,h.called==h.limit&&this.un(h.id),"all"==a)d.push(g);else if("merge"==
a&&g)d=d.concat(g);else{if("first"==a||"nonempty"==a&&g)return g;if("last"==a)d=g;else if(!1==a&&!1===g)return!1}if(a)return d}},!0,!1);return a}(),M=function(){var a=function(){this.events={}};m(a.prototype,{createEvent:function(b,a,e,f,g){b=b.toLowerCase();var d=this.events;d[b]||(d[b]=new F(b,a,e,f,g));return d[b]},getEvent:function(b){b=b.toLowerCase();return this.events[b]},on:function(b,a,e,f){b=b.toLowerCase();var g=this.events;g[b]||(g[b]=new F(b));return g[b].on(a,e,f)},once:function(b,a,
e,f){f=f||{};f.limit=1;return this.on(b,a,e,f)},un:function(b,a,e){b=b.toLowerCase();var f=this.events;f[b]&&f[b].un(a,e)},hasListener:function(b,a,e){var f=this.events;if(b)return b=b.toLowerCase(),f[b]?f[b].hasListener(a,e):!1;for(b in f)if(f[b].hasListener())return!0;return!1},removeAllListeners:function(b){var a=this.events;a[b]&&a[b].removeAllListeners()},trigger:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return null;b=a[b];return b.trigger.apply(b,q.call(arguments,
1))},suspendEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].suspend()},suspendAllEvents:function(){var b=this.events,a;for(a in b)b[a].suspend()},resumeEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].resume()},resumeAllEvents:function(){var b=this.events,a;for(a in b)b[a].resume()},destroyEvent:function(b){var a=this.events;a[b]&&(a[b].removeAllListeners(),a[b].destroy(),delete a[b])},destroy:function(){var b=this.events,a;for(a in b)this.destroyEvent(a);for(a in this)this[a]=
null},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),c={},e,f=-1,g=a.length;++f<g;e=a[f],c[e]=K(this[e],this));this.api=c}return this.api}},!0,!1);return a}(),N=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,s=function(a){var b=
a.match(N)||[],c=("undefined"!=typeof window?window.location:null)||{};return{protocol:b[4]||c.protocol||"http:",hostname:b[11]||c.hostname||"",host:(b[11]||"")+(b[12]?":"+b[12]:"")||c.host||"",username:b[8]||c.username||"",password:b[9]||c.password||"",port:parseInt(b[12],10)||c.port||"",href:a,path:(b[13]||"/")+(b[16]||""),pathname:b[13]||"/",search:b[16]||"",hash:b[17]&&"#"!=b[17]?b[17]:""}},x=function(a,b){var c="";b=b||{};b.onlyPath||(c+=a.protocol+"//",a.username&&a.password&&(c+=a.username+
":"+a.password+"@"),c+=a.hostname,a.hostname&&a.port&&(c+=":"+a.port));b.onlyHost||(c+=a.pathname||"/",a.search&&"?"!=a.search&&(c+=a.search),a.hash&&"#"!=a.hash&&(c+=a.hash));return c},O=function(){var a,b,c,e=new M,f,g,d="undefined"==typeof window,h=null,k,n,l;e.createEvent("before-location-change",!1);var q=function(a,b){"string"==typeof a&&(a=s(a));"string"==typeof b&&(b=s(b));var c=["protocol","host","port"],f,d,g;f=0;for(d=c.length;f<d;f++)if(g=c[f],a[g]&&b[g]&&a[g]!=b[g])return!0;return!1},
t=function(a,b){"string"==typeof a&&(a=s(a));"string"==typeof b&&(b=s(b));return q(a,b)||a.pathname!=b.pathname||a.search!=b.search||a.hash!=b.hash},r=function(a){a=s(a);if(!k||l)a.hash="#!"+encodeURIComponent(a.path),a.pathname="/",a.search="";return x(a,{onlyPath:!0})},u=function(a){c.hash=a?"!"+a:""},p=function(){var a,b;k?a=x(c):(a=c.hash.substr(1),b=m({},c,!0,!1),a&&("!"==a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a).split("?"),b.pathname=a[0],b.search=a[1]?"?"+a[1]:""),a=x(b));return a},
z=function(a){h=m({},c,!0,!1);v("location-change",a)},B=function(){if(t(h,c)){var a=p();h=m({},c,!0,!1);v("location-change",a)}},v=function(a,b){var c=b||p();return e.trigger(a,c)},y=function(){a=window;b=a.history;c=a.location;k=!!b.pushState;n="onhashchange"in a;l=k&&(navigator.vendor||"").match(/Opera/);h=m({},c,!0,!1);if(k)A(a,"popstate",B),f=function(a){if(!1===v("before-location-change",a))return!1;b.pushState(null,null,r(a));z(a)},g=function(a){if(!1===v("before-location-change",a))return!1;
b.replaceState(null,null,r(a));z(a)};else if(n)g=f=function(a){if(!1===v("before-location-change",a))return!1;D(u,null,[r(a)])},A(a,"hashchange",B);else{var e=null,p=!1;a.onIframeHistoryChange=function(a){p||D(function(){u(a);B()})};var G=function(a){var b=e.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');b.close()};
f=function(a){if(!1===v("before-location-change",a))return!1;G(r(a))};g=function(a){if(!1===v("before-location-change",a))return!1;a=r(a);e.contentWindow.hashValue=a};var x=function(){e=window.document.createElement("iframe");e.src="about:blank";e.style.display="none";window.document.body.appendChild(e);p=!0;G(r(c.hash.substr(1)));p=!1};d?x():A(a,"load",x)}A(window.document.documentElement,"click",function(b){b=new w(b||a.event);for(var d=b.target,e;d&&"a"!=d.nodeName.toLowerCase();)d=d.parentNode;
if(d&&!b.isDefaultPrevented()){e=d.getAttribute?d.getAttribute("href"):null;if("#"==e)return b.preventDefault(),b.stopPropagation(),!1;if(e&&"#"!=e.substr(0,1)&&(!d.getAttribute||!d.getAttribute("target"))){var d=m({},c,!0,!1),g=s(e);if(q(d,g))return null;t(d,g)&&f(e);b.preventDefault();b.stopPropagation();return!1}}return null});y=I};A(window,"load",function(){d=!0});return m({},e.getApi(),{push:function(a){y();b.pushState(null,null,a)},replace:function(a){y();b.replaceState(null,null,a)},current:function(){y();
return p()},init:function(){return y()},polyfill:function(){y();window.history.pushState=function(a,b,c){f(c)};window.history.replaceState=function(a,b,c){g(c)}}})}(),z={};z.history=O;"undefined"!=typeof global?global.MetaphorJs=z:window.MetaphorJs=z})();
